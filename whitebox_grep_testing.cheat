% whitebox web testing for exploits, source code review

$ wordlist: locate whitebox-wordlists | grep '\.txt' | sort -u 
$ blacklist: locate blacklist | grep '\.txt' | sort -u

# repo scan
cat <wordlist> | while read line;
do
    echo "current statment: $line"
    grep --color -inR --fixed-strings  $line
done


# find all files in current workdirectory with blacklist on `.js .html .md .lock .json .log *vendor* */.git*` and filter on wordlist.
find . -type f -exec grep -Iq . {} \; -print | grep -iv '\.js$\|\.html$\|\.md$\|\.lock$\|\.json$\|\.log$\|vendor\|\/\.git' | while read file;
do
    results=$(grep -i --fixed-strings -f <wordlist> $file)
    if [ -n "$results" ];
    then
        echo -e "results in file: $file:"
        grep --color -in --fixed-strings -f <wordlist> $file
    else
        echo "no results found in file: $file"
    fi
done


# find all files in current workdirectory with blacklist files on `regex` and filter on wordlist.
find . -type f -exec grep -Iq . {} \; -print | grep -iv '<regex>' | while read file;
do
    results=$(grep -i --fixed-strings -f <wordlist> $file)
    if [ -n "$results" ];
    then
        echo -e "results in file: $file:"
        grep --color -in --fixed-strings -f <wordlist> $file
    else
        echo "no results found in file: $file"
    fi
done

# find all files in current workdirectory with blacklist as wordlist and filter(s) as a wordlist
find . -type f -exec grep -Iq . {} \; -print | grep -ivf <blacklist> | while read file;
do
    results=$(grep -i --fixed-strings -f <wordlist> $file)
    if [ -n "$results" ];
    then
        echo -e "results in file: $file:"
        grep --color -in --fixed-strings -f <wordlist> $file
    else
        echo "no results found in file: $file"
    fi
done

